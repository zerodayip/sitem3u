name: Keep Proxy Alive

on:
  schedule:
    - cron: "*/15 * * * *"  # Her 15 dakikada bir çalışır (UTC)
  workflow_dispatch:

jobs:
  ping-job:
    runs-on: ubuntu-latest

    steps:
      - name: Install xmllint
        run: sudo apt-get update && sudo apt-get install -y libxml2-utils

      - name: Fetch and Print "Sistem şu anda aktif" from HTML
        run: |
          HTML=$(curl -s https://diziboxproxy.onrender.com/proxy/ping)
          TEXT=$(echo "$HTML" | xmllint --html --xpath "string(//h1)" - 2>/dev/null)
          if [[ -z "$TEXT" ]]; then
            echo "❌ Sistem pasif olabilir!"
          else
            echo "$TEXT"
          fi
