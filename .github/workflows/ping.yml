name: Keep Proxy Alive

on:
  schedule:
  - cron: '0 0 * * *'     # 00:00
  - cron: '30 5 * * *'    # 05:30
  - cron: '0 11 * * *'    # 11:00
  - cron: '30 16 * * *'   # 16:30
  - cron: '0 22 * * *'    # 22:00



jobs:
  keep-alive:
    runs-on: ubuntu-latest
    steps:
      - name: 5 saat boyunca her 10 dakikada bir ping at
        run: |
          END_TIME=$((SECONDS + 5 * 60 * 60))  # 5 saat = 5 * 60 * 60 saniye

          while [ $SECONDS -lt $END_TIME ]; do
            echo "üîÑ Yeni ping atƒ±lƒ±yor: $(date '+%Y-%m-%d %H:%M:%S')"
            HTML=$(curl -s https://diziboxproxy.onrender.com/proxy/ping)
            TEXT=$(echo "$HTML" | grep -oP '(?<=<h1>).*?(?=</h1>)')
            
            if [[ -z "$TEXT" ]]; then
              echo "‚ùå Sistem pasif olabilir!"
            else
              echo "‚úÖ $TEXT"
            fi
            
            echo "‚è≥ 10 dakika bekleniyor..."
            sleep 600  # 10 dakika
          done

          echo "‚úÖ 5 saatlik √ßalƒ±≈üma tamamlandƒ±."
